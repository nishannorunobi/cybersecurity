docker run -d \
  -e ORACLE_PASSWORD=oracle \
  -p 1521:1521 \
  -v oracle-volume:/opt/oracle/oradata \
  gvenzl/oracle-xe:21-slim

#connect system user with
username : system
password: oracle
service name: xe
port : 1521

# Create testdb user
create user testdb identified by testdb;

GRANT CONNECT, RESOURCE, CREATE SESSION, CREATE TABLE, CREATE VIEW, CREATE PROCEDURE, UNLIMITED TABLESPACE TO testdb;

CREATE TABLE users (
    user_id        NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    username       VARCHAR2(50) NOT NULL UNIQUE,
    password_hash  VARCHAR2(255) NOT NULL,
    email          VARCHAR2(100) UNIQUE,
    full_name      VARCHAR2(100),
    is_active      CHAR(1) DEFAULT 'Y' CHECK (is_active IN ('Y', 'N')),
    created_at     TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at     TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE OR REPLACE TRIGGER trg_users_updated_at
BEFORE UPDATE ON users
FOR EACH ROW
BEGIN
    :NEW.updated_at := CURRENT_TIMESTAMP;
END;
/


-- Inserting a new user with a unique username, email, and password hash
INSERT INTO users (username, password_hash, email, full_name, is_active)
VALUES ('johndoe', 'hashed_password_123', 'johndoe@example.com', 'John Doe', 'Y');

-- Inserting another user
INSERT INTO users (username, password_hash, email, full_name, is_active)
VALUES ('janedoe', 'hashed_password_456', 'janedoe@example.com', 'Jane Doe', 'Y');

-- Inserting a user with an inactive status
INSERT INTO users (username, password_hash, email, full_name, is_active)
VALUES ('inactiveuser', 'hashed_password_789', 'inactiveuser@example.com', 'Inactive User', 'N');

-- Inserting a user without an email (email is nullable)
INSERT INTO users (username, password_hash, full_name, is_active)
VALUES ('nouseremail', 'hashed_password_012', 'No Email User', 'Y');

